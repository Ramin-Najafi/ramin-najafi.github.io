<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<meta name="description" content="Linen ‚Äî your personal memory assistant, supporting memories, reminders, and mental health.">
<meta name="theme-color" content="#000000">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="apple-mobile-web-app-title" content="Linen">
<title>Linen ‚Äî Your Personal Assistant</title>
<link rel="icon" type="image/png" sizes="192x192" href="./icon-192.png">
<link rel="apple-touch-icon" href="./icon-192.png">
<link rel="apple-touch-icon" sizes="192x192" href="./icon-192.png">
<link rel="manifest" href="./manifest.json">
<link rel="stylesheet" href="./styles.css">
</head>
<body>

<div id="onboarding-overlay">
    <div id="onboarding-wizard">
        <div class="step" id="step-1">
            <img src="./logo.png" alt="Linen Logo" class="onboarding-logo">
            <h1>Linen</h1>
            <p>Your AI companion that remembers everything.</p>
            <button type="button" id="get-started">Get Started</button>
        </div>
        <div class="step" id="step-2">
            <button type="button" class="close-onboarding" id="close-onboarding">√ó</button>
            <h2>Choose Your AI</h2>
            <p>Pick your favorite AI assistant. All are supported by Linen.</p>
            <div class="ai-provider-grid">
                <div class="ai-provider-card">
                    <button type="button" class="ai-provider-btn" data-provider="gemini" id="provider-gemini">
                        <span class="provider-icon">üü¢</span>
                        <span class="provider-name">Gemini</span>
                        <span class="provider-info">Free tier available</span>
                    </button>
                    <a href="https://aistudio.google.com/app/apikey" target="_blank" class="get-api-key-btn">Get API Key</a>
                </div>
                <div class="ai-provider-card">
                    <button type="button" class="ai-provider-btn" data-provider="chatgpt" id="provider-openai">
                        <span class="provider-icon">‚ö™</span>
                        <span class="provider-name">ChatGPT</span>
                        <span class="provider-info">GPT-4 / GPT-4 Turbo</span>
                    </button>
                    <a href="https://platform.openai.com/api/keys" target="_blank" class="get-api-key-btn">Get API Key</a>
                </div>
                <div class="ai-provider-card">
                    <button type="button" class="ai-provider-btn" data-provider="huggingface" id="provider-huggingface">
                        <span class="provider-icon">üî¥</span>
                        <span class="provider-name">Hugging Face</span>
                        <span class="provider-info">Open-source models</span>
                    </button>
                    <a href="https://huggingface.co/settings/tokens" target="_blank" class="get-api-key-btn">Get API Key</a>
                </div>
            </div>
            <div id="provider-setup">
                <!-- Provider-specific setup will be shown here -->
            </div>
            <p class="error-message" id="onboarding-error"></p>
        </div>
        <div class="step" id="step-3">
            <button type="button" class="close-onboarding" id="close-onboarding-step3">√ó</button>
            <h2>Install as App</h2>
            <p>What device are you using?</p>
            <div class="device-selector">
                <button type="button" data-device="android">Android</button>
                <button type="button" data-device="ios">iOS</button>
            </div>
            <div id="android-instructions" class="instructions">
                <h4 style="margin-bottom: 0.5rem;">Android (Chrome)</h4>
                <ol>
                    <li>In Chrome, tap the <strong>three-dot menu (‚ãÆ)</strong> in the top-right corner</li>
                    <li>Tap <strong>"Add to Home screen"</strong></li>
                    <li>A popup will appear‚Äîtap the <strong>"Add"</strong> button</li>
                    <li>Linen will appear on your home screen as an app icon</li>
                </ol>
                <p style="font-size: 0.85rem; color: var(--text-light); margin-top: 0.5rem;"><em>Tip: Chrome may show an automatic "Install" prompt when you visit Linen‚Äîyou can tap that too!</em></p>
            </div>
            <div id="ios-instructions" class="instructions">
                <h4 style="margin-bottom: 0.5rem;">iOS (Safari)</h4>
                <ol>
                    <li>In Safari, tap the <strong>Share button</strong> (looks like a box with an arrow ‚¨ÜÔ∏è) at the bottom of your screen</li>
                    <li>Scroll down in the share menu and tap <strong>"Add to Home Screen"</strong></li>
                    <li>You can customize the app name if you want</li>
                    <li>Tap the <strong>"Add"</strong> button in the top-right corner</li>
                    <li>Linen will appear on your home screen as an app icon</li>
                </ol>
                <p style="font-size: 0.85rem; color: var(--text-light); margin-top: 0.5rem;"><em>Tip: You can also use Chrome, Firefox, or Edge instead of Safari‚Äîthey all work the same way!</em></p>
            </div>
            <div class="onboarding-nav">
                <button type="button" id="finish-onboarding">Done</button>
            </div>
        </div>
        <div class="step-indicator">
            <span class="dot active"></span>
            <span class="dot"></span>
            <span class="dot"></span>
        </div>
    </div>
</div>

<div id="pitch-modal" class="modal pitch-accordion">
    <button class="close-modal" id="close-pitch-modal-btn">√ó</button>
    <h2>Welcome to Linen</h2>
    <p>Your AI companion that respects your privacy.</p>

    <!-- Pitch Content -->
    <div class="pitch-content">
        <p class="pitch-description">Linen is a personal AI assistant that actually respects your privacy. Unlike other apps, everything you talk to Linen about stays on your device‚Äîwe don't sell your data or train on your conversations. It learns who you are over time, remembers what matters to you, and helps with reminders, planning, or just being there when you need support. Think of it as an AI that's actually on your side.</p>

        <!-- Start Chatting Now - Accordion Dropdown -->
        <div class="accordion-container">
            <div class="accordion-item">
                <button class="accordion-header" data-section="start">
                    <span>‚ö° Start Chatting Now</span>
                    <span class="accordion-icon">‚ñº</span>
                </button>
                <div class="accordion-content" id="start">
                    <p>Start chatting right now with Linen's built-in AI. It's a great listener and helpful friend. Want even smarter features? Add your favorite AI provider's API key anytime to unlock memories, reminders, and deeper conversations.</p>
                    <p style="font-size: 0.9rem; color: #999;"><strong>Your conversations with Linen always stay private on your device‚Äîthe API key only tells Linen which AI service you prefer to use.</strong></p>
                </div>
            </div>
        </div>

        <div class="pitch-section">
            <h3>Works With Your Favorite AI:</h3>
            <div class="provider-badges">
                <span class="badge">üü¢ Gemini</span>
                <span class="badge">‚ö™ ChatGPT</span>
                <span class="badge">üî¥ Hugging Face</span>
            </div>
        </div>

        <div class="pitch-section">
            <h3>Key Features:</h3>
            <ul class="pitch-features">
                <li>üîí Privacy First</li>
                <li>üß† Personalized</li>
                <li>üë§ You Own Your Data</li>
                <li>ü§ñ Use Your Favorite AI</li>
                <li>üí¨ Start Chatting Immediately</li>
            </ul>
        </div>
    </div>

    <div class="pitch-buttons">
        <button id="close-pitch-modal" class="button-primary">Start Chatting</button>
        <button id="get-api-key-direct" class="button-secondary">Get API Keys</button>
    </div>
</div>

<div id="about-modal" class="modal about-accordion">
    <button type="button" class="close-modal" id="close-about-modal">√ó</button>
    <div class="about-header">
        <h2>About Linen</h2>
    </div>

    <div class="about-content">
        <!-- Section 1: What is Linen -->
        <div class="accordion-item">
            <button type="button" class="accordion-header" data-section="what-is-linen">
                <span class="accordion-title">What is Linen?</span>
                <span class="accordion-icon">‚ñº</span>
            </button>
            <div class="accordion-body">
                <p class="accordion-preview">Linen is a privacy-first conversational AI assistant that learns from your conversations and remembers what matters to you‚Äîeverything stays on your device.</p>
                <div class="accordion-content" style="display: none;">
                    <p>Linen is a sophisticated web application designed to be your digital companion. It learns from your conversations, remembers what matters to you, and provides thoughtful responses when you need them most.</p>
                    <p>Unlike traditional note-taking apps or journaling tools, Linen is interactive. It engages in real conversations, understands context, and helps you work through problems while preserving your memories.</p>
                    <p><strong>What if your personal assistant never forgot a detail about your life, understood your emotions, and worked completely offline?</strong> That's Linen.</p>

                    <h4 style="margin-top: 1rem; color: var(--accent);">üí¨ Conversational AI</h4>
                    <p>Talk to Linen like you'd talk to a real companion. Get thoughtful, contextual responses that understand your emotional state. Switch between AI-powered mode (with your API key) or local mode (completely offline, no API needed). Linen provides emotional support when you're stressed and celebrates when you're happy.</p>

                    <h4 style="margin-top: 1rem; color: var(--accent);">üß† Intelligent Memory System</h4>
                    <p>Linen learns important details from your conversations automatically‚Äîno manual input needed. Tag memories for easy searching, find them by keyword, date, or tags, and see emotional context for each memory. Build a personal knowledge base of your life that actually understands you.</p>

                    <h4 style="margin-top: 1rem; color: var(--accent);">üóìÔ∏è Calendar & Reminders</h4>
                    <p>Create calendar events from natural language. Set reminders for important dates. Linen helps you stay organized without friction‚Äîjust mention what you need to remember and Linen handles it intelligently.</p>

                    <h4 style="margin-top: 1rem; color: var(--accent);">üë§ Personal Profile</h4>
                    <p>Customize your experience with your name, pronouns, timezone. Get automatic birthday greetings and personalized responses that feel genuinely connected to who you are.</p>

                    <h4 style="margin-top: 1rem; color: var(--accent);">üì± Progressive Web App</h4>
                    <p>Install on your phone, tablet, or desktop. It feels like a native app, works offline seamlessly, and runs fast with a beautiful, responsive UI.</p>

                    <p style="margin-top: 1rem;"><strong>And the best part?</strong> Everything stays on your device. Your memories never leave your computer or phone. There's no cloud, no servers analyzing your data, no algorithms tracking your behavior.</p>
                </div>
            </div>
        </div>

        <!-- Section 2: Core Principles -->
        <div class="accordion-item">
            <button type="button" class="accordion-header" data-section="core-principles">
                <span class="accordion-title">Core Principles</span>
                <span class="accordion-icon">‚ñº</span>
            </button>
            <div class="accordion-body">
                <p class="accordion-preview">Linen is built on privacy-first principles: your data stays on your device, works completely offline, and gives you full control‚Äîno tracking, no ads, no data collection.</p>
                <div class="accordion-content" style="display: none;">
                    <h4 style="color: var(--accent);">üîê Privacy First</h4>
                    <p>All your data is stored locally using IndexedDB‚Äîa secure, persistent database that lives on your device. Your conversations and memories never leave your computer or phone unless you explicitly choose to connect an API provider. We don't have access to your data. We can't read it. We don't want it.</p>

                    <h4 style="margin-top: 1rem; color: var(--accent);">üéÆ You Control Everything</h4>
                    <p>Optional API key integration means you choose which AI provider powers your experience. Supported providers: Google Gemini (free tier available) and OpenAI ChatGPT. Switch between providers anytime. Use multiple providers and pick your favorite. You're in control.</p>

                    <h4 style="margin-top: 1rem; color: var(--accent);">üåê Works Offline</h4>
                    <p>Full functionality without internet connection. Linen includes a built-in Local Assistant that provides intelligent responses completely offline. A Service Worker handles smart caching, so you can access your memories even without internet. No internet? No problem.</p>

                    <h4 style="margin-top: 1rem; color: var(--accent);">üìä No Tracking, No Ads</h4>
                    <p>Zero data collection. Zero surveillance. Zero hidden tracking. We don't build profiles on you. We don't sell your data. We don't train models on your conversations. Linen is 100% free with no freemium model, no premium features, no upselling.</p>

                    <h4 style="margin-top: 1rem; color: var(--accent);">üíæ Export or Delete Anytime</h4>
                    <p>Your data is genuinely yours. Export everything in a standard format and take it with you. Or delete it all with a single click. You're never locked in. You can leave anytime without losing your memories‚Äîthey're yours to keep.</p>

                    <h4 style="margin-top: 1rem; color: var(--accent);">üéØ Built for Real Use Cases</h4>
                    <p><strong>Students:</strong> Remember key concepts from learning sessions. Have a study buddy that quizzes you on past material. Keep a structured learning journal.<br><strong>Professionals:</strong> Capture meeting notes conversationally. Build a personal knowledge base. Get reminders for follow-ups.<br><strong>Mental Health & Wellness:</strong> Journal and reflect with AI support. Track mood patterns over time. Get gentle encouragement when struggling.<br><strong>Creatives:</strong> Brainstorm ideas with an engaged listener. Keep an inspiration log. Review past work for patterns.</p>
                </div>
            </div>
        </div>

        <!-- Section 3: The Future -->
        <div class="accordion-item">
            <button type="button" class="accordion-header" data-section="future">
                <span class="accordion-title">The Future of Linen</span>
                <span class="accordion-icon">‚ñº</span>
            </button>
            <div class="accordion-body">
                <p class="accordion-preview">Linen is continuously evolving with planned features including encrypted cloud sync, advanced collaboration tools, and deeper AI model integration while maintaining its privacy-first philosophy.</p>
                <div class="accordion-content" style="display: none;">
                    <h4 style="color: var(--accent);">üìã Implemented Features</h4>
                    <ul>
                        <li><strong>üîÑ Background Update Checks:</strong> Linen silently checks for updates in the background without disrupting your work. Adaptive check intervals respect your device's power and connection: 5 minutes on WiFi (plugged), 15 minutes on WiFi (battery), 1 hour on cellular (plugged), 4 hours on cellular (battery). When a new version is available, a gentle notification suggests closing and reopening the app to get the latest features.</li>
                        <li><strong>üé§ Voice Input:</strong> Talk to Linen using natural voice input. Your voice is processed locally with a clean, intuitive interface. Perfect for hands-free interaction when typing isn't convenient.</li>
                        <li><strong>üíæ Smart Memory Management:</strong> Automatic memory detection and tagging from conversations. Intelligent memory surfacing to help you remember what matters.</li>
                        <li><strong>üé® Beautiful, Responsive Design:</strong> Works seamlessly on desktop, tablet, and mobile with a thoughtful, minimal UI that respects your attention.</li>
                    </ul>

                    <h4 style="margin-top: 1rem; color: var(--accent);">üìã Planned Enhancements</h4>
                    <ul>
                        <li><strong>Cross-Device Sync:</strong> Optional encrypted cloud synchronization so your memories follow you across devices while remaining private</li>
                        <li><strong>Advanced Memory Features:</strong> Pattern analysis to identify trends, mood tracking over time to see emotional patterns, and intelligent memory surfacing to resurface relevant past conversations</li>
                        <li><strong>Collaboration Tools:</strong> Share specific conversations or memories with others while maintaining your privacy and control over what gets shared</li>
                        <li><strong>Deeper AI Integration:</strong> Custom prompt templates for specialized workflows, multi-language support, and expanded voice capabilities</li>
                        <li><strong>Community Features:</strong> Optional anonymous insight sharing to help improve Linen while protecting individual privacy</li>
                    </ul>

                    <h4 style="margin-top: 1rem; color: var(--accent);">üéØ Technical Vision</h4>
                    <p>Linen is built on cutting-edge web technologies: pure vanilla JavaScript (2000+ lines of well-organized, modular code), IndexedDB for local storage, Service Workers for offline functionality, and support for multiple AI providers through unified APIs. The architecture demonstrates that you don't need complex frameworks to build sophisticated applications.</p>

                    <h4 style="margin-top: 1rem; color: var(--accent);">üí° Why Linen Matters</h4>
                    <p><strong>Zero cost:</strong> Completely free, no ads, no tracking.<br><strong>Works offline:</strong> Full functionality without internet.<br><strong>Your data is yours:</strong> Everything stays on your device.<br><strong>Beautiful design:</strong> Thoughtful, minimal UI that's a joy to use.<br><strong>Easy to use:</strong> Intuitive without a learning curve.<br><strong>Production-ready code:</strong> Well-structured, maintainable JavaScript.<br><strong>Innovative:</strong> Combines multiple technologies in a genuinely useful way.<br><strong>Accessible:</strong> Designed for everyone.</p>

                    <h4 style="margin-top: 1rem; color: var(--accent);">üöÄ Long-term Vision</h4>
                    <p>Linen aims to become the most privacy-respecting personal AI assistant available. It's built on the belief that technology should work for you, not against you‚Äîhandling your data with the care it deserves. Not trying to replace specialized tools, but to be that one app you actually want to use every day.</p>

                    <h4 style="margin-top: 1rem; color: var(--accent);">‚ù§Ô∏è Built with Passion</h4>
                    <p>Linen is a labor of love, built to explore what's possible with modern web technologies. It's an example of sophisticated application architecture without frameworks, demonstrating advanced JavaScript patterns, real-world IndexedDB usage, Service Worker implementation, and responsive design principles.</p>

                    <p style="margin-top: 1rem; text-align: center; color: var(--accent); font-weight: bold;">Start chatting. Start remembering. Start living better.</p>
                </div>
            </div>
        </div>
    </div>

    <div class="about-footer">
        <p>¬© 2026 Ramin Najafi | <a href="https://ramin-najafi.github.io/" target="_blank">Portfolio</a></p>
        <p id="about-version" style="margin-top: 0.5rem; color: #fff; font-size: 0.85rem;">v.1.5.1[beta]</p>
    </div>
</div>

<div id="trial-limit-modal" class="modal">
    <h2>Free Preview Complete</h2>
    <p>You've used your 3 free chats. Get your own API key to continue chatting unlimitedly.</p>
    <a href="https://aistudio.google.com/app/apikey" target="_blank" class="button-primary">Get Free API Key</a>
    <button id="close-trial-modal" class="button-primary">Close</button>
</div>

<div id="re-enter-key-modal" class="modal">
    <h2>Invalid API Key</h2>
    <p>Your API key is no longer working. Please enter a new one to continue.</p>
    <input type="password" id="re-enter-api-key" placeholder="Paste your new API key here">
    <button id="save-re-enter-api-key">Save Key</button>
    <p class="error-message" id="re-enter-error"></p>
</div>

<div id="voice-modal" class="modal voice-lightbox">
    <h2>Voice Input</h2>
    <div id="lightbox-voice-display" class="lightbox-voice-display">üé§ Listening...</div>
    <button type="button" id="lightbox-stop-btn" class="button-danger">Stop Recording</button>
</div>

<div id="crisis-modal" class="modal crisis-modal">
    <button class="close-modal" id="close-crisis-modal">√ó</button>
    <h2 style="color: #ff6b6b;">You're Not Alone</h2>
    <p style="color: #fff; font-size: 1.1rem; margin: 1.5rem 0;">If you're in crisis, please reach out to someone who can help:</p>
    <div class="crisis-resources">
        <div class="resource">
            <h3>United States</h3>
            <p><strong>988 Suicide & Crisis Lifeline</strong></p>
            <p>Call or text 988 (available 24/7)</p>
            <p><a href="https://988lifeline.org" target="_blank" style="color: #4a9eff;">988lifeline.org</a></p>
        </div>
        <div class="resource">
            <h3>International</h3>
            <p><strong>Find Your Country's Crisis Line</strong></p>
            <p><a href="https://findahelpline.com" target="_blank" style="color: #4a9eff;">findahelpline.com</a></p>
            <p><a href="https://www.befrienders.org" target="_blank" style="color: #4a9eff;">befrienders.org</a></p>
        </div>
        <div class="resource">
            <h3>Text-Based Support</h3>
            <p><strong>Crisis Text Line</strong></p>
            <p>Text HOME to 741741 (US)</p>
            <p><a href="https://www.crisistextline.org" target="_blank" style="color: #4a9eff;">crisistextline.org</a></p>
        </div>
    </div>
    <p style="color: #ddd; margin-top: 2rem; font-size: 0.95rem;">I'm here to listen and support you, but if you're in immediate danger, please call emergency services (911 in US) or go to your nearest emergency room.</p>
    <button id="acknowledge-crisis" class="button-primary">I'm Safe / Need to Talk</button>
</div>


<div id="add-agent-modal" class="modal">
    <button class="close-modal" id="close-add-agent">√ó</button>
    <h2>Add New Agent</h2>
    <div class="form-group">
        <label for="agent-name">Agent Name:</label>
        <input type="text" id="agent-name" placeholder="e.g., My Gemini, ChatGPT Pro">
        <span class="form-help">Give your agent a nickname to remember it</span>
        <span class="form-field-error" id="agent-name-error"></span>
    </div>
    <div class="form-group">
        <label for="agent-type">AI Provider:</label>
        <select id="agent-type">
            <option value="">Select a provider</option>
            <option value="gemini">Google Gemini</option>
            <option value="openai">OpenAI (ChatGPT)</option>
            <option value="openrouter">OpenRouter</option>
        </select>
        <span class="form-help">Choose your preferred AI provider</span>
        <span class="form-field-error" id="agent-type-error"></span>
    </div>
    <div class="form-group">
        <label for="agent-api-key">API Key:</label>
        <input type="password" id="agent-api-key" placeholder="Paste your API key">
        <span class="form-help">Your API key is stored locally. We never see it or send it anywhere.</span>
        <span class="form-field-error" id="agent-api-key-error"></span>
    </div>
    <div class="form-group">
        <label for="agent-model">Model (optional):</label>
        <input type="text" id="agent-model" placeholder="e.g., gpt-4, claude-3-opus">
        <span class="form-help">Leave blank to use default. Examples: gpt-4, claude-3-opus</span>
    </div>
    <div class="form-group">
        <label>
            <input type="checkbox" id="agent-primary">
            Set as primary agent
        </label>
    </div>
    <button id="save-new-agent" class="button-primary">Add Agent</button>
    <p class="error-message" id="add-agent-error"></p>
</div>

<div id="app-container">
    <a href="#chat-input" class="skip-link" id="skip-to-chat">Skip to main chat</a>
    <header>
        <div class="header-logo-container">
            <div class="logo-wrapper">
                <img src="./logo.png" alt="Linen Logo" id="logo" class="interactive-logo">
                <div class="version-badge" id="header-version">v.1.5.1[beta]</div>
            </div>
            <div id="logo-menu" class="logo-menu hidden">
                <button type="button" id="logo-utilities" class="menu-item">‚ö° Utilities</button>
                <button type="button" id="logo-new-chat" class="menu-item">üí¨ New Chat</button>
                <button type="button" id="logo-memories" class="menu-item">üìö Memories</button>
                <button type="button" id="logo-settings" class="menu-item">‚öô Settings</button>
            </div>
        </div>
    </header>

    <main class="main-content" id="chat-view">
        <div id="chat-messages"></div>
        <div id="chat-input-area">
            <!-- Default state: Hamburger + Input + Send button -->
            <div id="input-default-row" class="input-default-row">
                <button id="hamburger-menu-btn" class="hamburger-menu-btn" aria-label="Open navigation menu" title="Open navigation menu">&#9776;</button>
                <textarea id="chat-input" placeholder="Ask me anything..." rows="1"></textarea>
                <button id="send-message-btn" class="send-message-btn" aria-label="Send message" title="Send message (Enter)">Send</button>
            </div>
            <div id="input-buttons" class="input-buttons">
                <button id="chat-type" class="input-btn" aria-label="Switch to text input mode" title="Type message">Text</button>
                <button id="chat-talk" class="input-btn" aria-label="Switch to voice input mode" title="Voice input">Talk</button>
            </div>

            <!-- Text input mode -->
            <div id="text-input-mode" class="input-mode" style="display: none;">
                <div class="input-actions">
                    <button id="mode-switcher" class="mode-btn" title="Switch mode">+</button>
                    <button id="send-btn" class="send-btn">Send</button>
                </div>
            </div>

            <!-- Voice input mode -->
            <div id="voice-input-mode" class="input-mode" style="display: none;">
                <div id="voice-status-display" class="voice-status-display">üé§ Listening...</div>
                <div class="input-actions">
                    <button id="voice-mode-switcher" class="mode-btn" title="Switch mode">+</button>
                    <button id="stop-voice-btn" class="send-btn">Stop</button>
                </div>
            </div>
        </div>
    </main>

    <div id="voice-status"></div>

    <!-- Modals and Panels -->
    <div id="modal-backdrop"></div>

    <aside id="memories-panel" aria-label="Memories sidebar">
        <button class="close-panel" id="close-memories">√ó</button>
        <input id="memory-search" placeholder="Search memories...">
        <div id="memories-list"></div>
    </aside>

    <!-- Utilities Modal -->
    <div class="modal" id="utilities-modal" aria-label="Utilities panel">
        <button class="close-modal" id="close-utilities-modal">√ó</button>
        <div class="utilities-header">
            <h2>‚ö° Utilities</h2>
            <div class="utilities-tabs">
                <button type="button" class="utilities-tab active" data-tab="alarm-timer">‚è∞ Alarm & Timer</button>
                <button type="button" class="utilities-tab" data-tab="notes">üìù Notes</button>
                <button type="button" class="utilities-tab" data-tab="calendar">üìÖ Calendar</button>
                <button type="button" class="utilities-tab" data-tab="reminders">üîî Reminders</button>
            </div>
        </div>

        <!-- Alarm & Timer Tab -->
        <div id="alarm-timer-tab" class="utilities-tab-content active">
            <!-- Alarm Clock -->
            <div class="utility-section">
                <h3>‚è∞ Alarm Clock</h3>
                <div class="alarm-setup">
                    <input type="time" id="alarm-time" />
                    <input type="text" id="alarm-label" placeholder="Label (e.g., Wake up)" />
                    <button type="button" id="set-alarm-btn" class="button-primary">Set Alarm</button>
                </div>
                <div id="active-alarms-list" class="active-utilities-list">
                    <h4>Active Alarms</h4>
                    <div id="alarms-container"></div>
                </div>
            </div>

            <!-- Timer -->
            <div class="utility-section">
                <h3>‚è±Ô∏è Timer</h3>
                <div class="timer-setup">
                    <input type="number" id="timer-minutes" placeholder="Minutes" min="0" max="59" />
                    <input type="number" id="timer-seconds" placeholder="Seconds" min="0" max="59" />
                    <button type="button" id="start-timer-btn" class="button-primary">Start Timer</button>
                </div>
                <div id="active-timers-list" class="active-utilities-list">
                    <h4>Active Timers</h4>
                    <div id="timers-container"></div>
                </div>
            </div>
        </div>

        <!-- Notes Tab -->
        <div id="notes-tab" class="utilities-tab-content">
            <div class="utility-section">
                <h3>üìù Notes</h3>
                <textarea id="note-input" placeholder="Write your note here..." rows="6"></textarea>
                <div class="notes-actions">
                    <button type="button" id="save-note-btn" class="button-primary">Save Note</button>
                    <button type="button" id="share-note-btn" class="button-secondary">Share Note</button>
                </div>
                <div id="notes-list" class="notes-list">
                    <h4>My Notes</h4>
                    <div id="notes-container"></div>
                </div>
            </div>
        </div>

        <!-- Calendar Tab -->
        <div id="calendar-tab" class="utilities-tab-content">
            <div class="utility-section">
                <h3>üìÖ Calendar</h3>
                <div class="event-setup">
                    <input type="text" id="event-title" placeholder="Event name" />
                    <input type="datetime-local" id="event-datetime" />
                    <textarea id="event-description" placeholder="Event description" rows="3"></textarea>
                    <button type="button" id="add-event-btn" class="button-primary">Add Event</button>
                </div>
                <div id="events-list" class="events-list">
                    <h4>Upcoming Events</h4>
                    <div id="events-container"></div>
                </div>
            </div>
        </div>

        <!-- Reminders Tab -->
        <div id="reminders-tab" class="utilities-tab-content">
            <div class="utility-section">
                <h3>üîî Reminders</h3>
                <div class="reminder-setup">
                    <input type="text" id="reminder-text" placeholder="What do you want to remember?" />
                    <input type="datetime-local" id="reminder-time" />
                    <select id="reminder-method">
                        <option value="push">Push Notification</option>
                        <option value="email">Email Notification</option>
                    </select>
                    <button type="button" id="create-reminder-btn" class="button-primary">Create Reminder</button>
                </div>
                <div id="reminders-list" class="reminders-list">
                    <h4>Active Reminders</h4>
                    <div id="reminders-container"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="settings-modal" aria-label="Settings panel">
        <button class="close-modal" id="close-settings-modal">√ó</button>

        <div class="settings-section" id="profile-section">
            <button type="button" class="accordion-header" id="profile-accordion-btn">
                <span>üë§ User Profile</span>
                <span class="accordion-icon">‚ñº</span>
            </button>
            <div id="profile-form" class="profile-form" style="display: none;">
                <div class="form-group">
                    <label for="profile-first-name">First Name</label>
                    <input type="text" id="profile-first-name" placeholder="Your first name" autocomplete="given-name">
                </div>
                <div class="form-group">
                    <label for="profile-last-name">Last Name</label>
                    <input type="text" id="profile-last-name" placeholder="Your last name" autocomplete="family-name">
                </div>
                <div class="form-group">
                    <label for="profile-email">Email (optional)</label>
                    <input type="email" id="profile-email" placeholder="your@email.com" autocomplete="email">
                </div>
                <div class="form-group">
                    <label for="profile-pronouns">Pronouns</label>
                    <select id="profile-pronouns">
                        <option value="">Select pronouns</option>
                        <option value="he/him">he/him</option>
                        <option value="she/her">she/her</option>
                        <option value="they/them">they/them</option>
                        <option value="custom">Custom</option>
                    </select>
                    <input type="text" id="profile-pronouns-custom" placeholder="Enter your pronouns" style="display:none; margin-top:8px;">
                </div>
                <div class="form-group" id="profile-dob-group">
                    <label for="profile-dob">Date of Birth</label>
                    <input type="date" id="profile-dob">
                    <span class="form-help">Used for birthday messages ‚Äî stored only on your device</span>
                </div>
                <div id="profile-dob-saved" class="profile-dob-saved" style="display:none;">
                    <span>‚úì Birthday saved</span>
                </div>
                <div class="form-group">
                    <label for="profile-timezone">Timezone</label>
                    <select id="profile-timezone">
                        <option value="">Auto-detect</option>
                    </select>
                </div>
                <div class="settings-btn-group" style="margin-top: 8px;">
                    <button id="save-profile" class="settings-btn settings-btn-primary">Save Profile</button>
                    <button id="clear-profile" class="settings-btn settings-btn-danger">Clear Profile Data</button>
                </div>
            </div>
        </div>

        <div class="settings-section">
            <h3 class="settings-heading">üì± Installation</h3>
            <button id="install-app-btn" class="settings-btn settings-btn-primary">Install Linen as App</button>
        </div>

        <div class="settings-section">
            <h3 class="settings-heading">ü§ñ AI Agents</h3>
            <button id="add-agent-btn" class="settings-btn settings-btn-primary">+ Add New Agent</button>
            <div id="agents-list"></div>
        </div>

        <div class="settings-section">
            <h3 class="settings-heading">üóÇÔ∏è Data Management</h3>
            <div class="settings-btn-group">
                <button id="export-data" class="settings-btn settings-btn-secondary">Export Memories</button>
                <button id="clear-chat-history" class="settings-btn settings-btn-danger">Clear Chat History</button>
                <button id="clear-data" class="settings-btn settings-btn-danger">Clear All Data</button>
            </div>
        </div>

        <div class="settings-section">
            <h3 class="settings-heading">üì¨ Contact Support</h3>
            <div id="contact-form">
                <input type="text" id="contact-name" placeholder="Your Name">
                <input type="email" id="contact-email" placeholder="Your Email">
                <textarea id="contact-message" placeholder="Your Message"></textarea>
                <button id="submit-contact" class="settings-btn settings-btn-primary">Send</button>
                <p id="contact-status" class="settings-status"></p>
            </div>
        </div>

        <div class="settings-section">
            <h3 class="settings-heading">üí° Suggestions & Ideas</h3>
            <div id="suggestions-form">
                <textarea id="suggestion-text" placeholder="What would make Linen better for you?"></textarea>
                <button id="submit-suggestion" class="settings-btn settings-btn-primary">Send Suggestion</button>
                <p id="suggestion-status" class="settings-status"></p>
            </div>
        </div>

        <div class="settings-section" id="privacy-section">
            <h3 class="settings-heading">üîê Privacy & Terms</h3>
            <div class="trust-badges">
                <div class="trust-badge">
                    <span class="trust-badge-icon">üîí</span>
                    <div class="trust-badge-text">
                        <strong>Privacy First</strong>
                        <span>Your data never leaves your device</span>
                    </div>
                </div>
                <div class="trust-badge">
                    <span class="trust-badge-icon">üö´</span>
                    <div class="trust-badge-text">
                        <strong>Never</strong>
                        <span>Sell, share, or train AI on your data</span>
                    </div>
                </div>
                <div class="trust-badge">
                    <span class="trust-badge-icon">üíØ</span>
                    <div class="trust-badge-text">
                        <strong>Free</strong>
                        <span>No paywalls, no premium, no ads</span>
                    </div>
                </div>
            </div>
            <div class="settings-btn-group">
                <button id="show-privacy-policy" class="settings-btn settings-btn-secondary">Privacy Policy</button>
                <button id="show-terms" class="settings-btn settings-btn-secondary">Terms of Service</button>
            </div>

            <button type="button" id="share-linen-btn" class="settings-btn settings-btn-primary" style="margin-top: 1rem;">üì§ Share Linen</button>
        </div>

        <p id="version-info">Version-1.5.0 [beta]</p>
    </div>
</div>

<div id="privacy-modal" class="modal privacy-terms-modal">
    <button class="close-modal" id="close-privacy-modal">√ó</button>
    <h2>Linen Privacy Policy</h2>
    <div class="privacy-terms-content">
        <p class="privacy-highlight">Your privacy is Linen's #1 priority.</p>

        <h3>What Data Linen Stores</h3>
        <ul>
            <li>Your name, email, pronouns, birthday (only if you add them)</li>
            <li>Your conversations with Linen</li>
            <li>Your calendar events and reminders</li>
            <li>Your API keys (stored locally)</li>
            <li>Nothing else.</li>
        </ul>

        <h3>Where Your Data Lives</h3>
        <ul>
            <li>100% on YOUR device (your phone, your computer)</li>
            <li>Linen cannot access it</li>
        </ul>

        <h3>What Linen Does Not Do</h3>
        <ul class="privacy-never-list">
            <li>Never sells your data</li>
            <li>Never shares your data with anyone</li>
            <li>Never uses your data for ads or marketing</li>
            <li>Never trains AI models on your conversations</li>
            <li>Never accesses your device</li>
            <li>Never tracks you</li>
            <li>Never stores your data on any server</li>
        </ul>

        <h3>Your API Keys</h3>
        <ul>
            <li>Your ChatGPT and Gemini keys stay on YOUR device</li>
            <li>Linen cannot access them</li>
            <li>Only used locally by Linen</li>
            <li>Delete them anytime, they're gone forever</li>
        </ul>

        <h3>Email (If You Opt-In)</h3>
        <ul>
            <li>You can optionally provide your email</li>
            <li>Linen only sends emails if you enable notifications</li>
            <li>Unsubscribe anytime</li>
        </ul>

        <h3>Third Parties</h3>
        <ul>
            <li>If you choose to use external AI providers (ChatGPT, Gemini), they receive only what you send them</li>
            <li>Read their privacy policies to understand their practices</li>
            <li>Linen has no access to your API usage or data sent to them</li>
        </ul>

        <h3>Data Deletion</h3>
        <ul>
            <li>"Clear All Data" button in Settings permanently deletes everything</li>
            <li>No backups, no archives, no recovery</li>
            <li>Your data is completely yours to delete</li>
        </ul>

        <h3>Policy Changes</h3>
        <ul>
            <li>If this policy ever changes, you'll be notified in-app</li>
            <li>Changes will never reduce your privacy protections</li>
        </ul>

        <p class="privacy-date">Last updated: February 2026</p>
    </div>
    <button id="close-privacy-btn" class="button-primary" style="margin-top: 1rem;">Got It</button>
</div>

<div id="terms-modal" class="modal privacy-terms-modal">
    <button class="close-modal" id="close-terms-modal">√ó</button>
    <h2>Linen Terms of Service</h2>
    <div class="privacy-terms-content">
        <h3>You Own Your Data</h3>
        <ul>
            <li>Everything you create belongs to you</li>
            <li>Export it, delete it, modify it ‚Äî it's yours</li>
        </ul>

        <h3>Linen Provides the App As-Is</h3>
        <ul>
            <li>Free to use (as long as operational costs allow)</li>
            <li>Works offline, on your device</li>
            <li>No account required</li>
        </ul>

        <h3>You're Responsible For</h3>
        <ul>
            <li>Your API keys ‚Äî keep them secret, don't share them</li>
            <li>Your device security</li>
            <li>What you use Linen for</li>
        </ul>

        <h3>Linen is Not Liable For</h3>
        <ul>
            <li>Lost data (keep backups)</li>
            <li>Device crashes or errors</li>
            <li>Third-party service outages</li>
            <li>Internet connection issues</li>
        </ul>

        <h3>No Warranty</h3>
        <ul>
            <li>Linen is provided as-is without guarantees</li>
            <li>We try to keep it reliable, but bugs happen</li>
            <li>Not responsible for unexpected crashes</li>
        </ul>

        <h3>Data Ownership</h3>
        <ul>
            <li>You own all data you create in Linen</li>
            <li>You can delete it anytime</li>
            <li>Linen cannot delete your data without your permission</li>
        </ul>

        <h3>Termination</h3>
        <ul>
            <li>Stop using Linen anytime</li>
            <li>All your data stays yours</li>
        </ul>

        <p class="privacy-terms-law">Governing Law: Ontario, Canada</p>
        <p class="privacy-date">Last updated: February 2026</p>
    </div>
    <button id="close-terms-btn" class="button-primary" style="margin-top: 1rem;">Got It</button>
</div>

<div id="toast"></div>

<script src="./app.js"></script>
</body>
</html>