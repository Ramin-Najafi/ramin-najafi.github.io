<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Linen â€” your personal memory assistant, supporting memories, reminders, and mental health.">
<meta name="theme-color" content="#000000">
<title>Linen â€” Your Personal Assistant</title>
<link rel="icon" href="./favicon.svg">
<link rel="manifest" href="./manifest.json">
<link rel="stylesheet" href="./styles.css">
</head>
<body>

<div id="onboarding-overlay">
    <div id="onboarding-wizard">
        <div class="step" id="step-1">
            <img src="./logo.png" alt="Linen Logo" class="onboarding-logo">
            <h1>Linen</h1>
            <p>Your AI companion that remembers everything.</p>
            <button id="get-started">Get Started</button>
        </div>
        <div class="step" id="step-2">
            <h2>API Key Setup</h2>
            <p>Linen uses Google Gemini AI. You need a free API key to get started.</p>
            <ol>
                <li>Tap the button below to open Google AI Studio</li>
                <li>Sign in with your Google account</li>
                <li>Click 'Create API Key'</li>
                <li>Copy the key and paste it below</li>
            </ol>
            <a href="https://aistudio.google.com/app/apikey" target="_blank" class="button">Go to Google AI Studio</a>
            <input type="password" id="onboarding-api-key" placeholder="Paste your API key here">
            <button id="save-onboarding-api-key">Save and Continue</button>
            <p class="error-message" id="onboarding-error"></p>
        </div>
        <div class="step" id="step-3">
            <h2>Install as App</h2>
            <p>What device are you using?</p>
            <div class="device-selector">
                <button data-device="android">Android</button>
                <button data-device="ios">iOS</button>
            </div>
            <div id="android-instructions" class="instructions">
                <ol>
                    <li>Tap the three-dot menu (â‹®) in the top-right of Chrome</li>
                    <li>Tap "Add to Home screen" or "Install app"</li>
                    <li>Tap "Install" to confirm</li>
                </ol>
            </div>
            <div id="ios-instructions" class="instructions">
                <ol>
                    <li>Tap the Share button (â–¡â†‘) at the bottom of Safari</li>
                    <li>Scroll down and tap "Add to Home Screen"</li>
                    <li>Tap "Add" in the top-right corner</li>
                </ol>
            </div>
            <div class="onboarding-nav">
                <button id="finish-onboarding">Done</button>
            </div>
        </div>
        <div class="step-indicator">
            <span class="dot active"></span>
            <span class="dot"></span>
            <span class="dot"></span>
        </div>
    </div>
</div>

<div id="pitch-modal" class="modal">
    <h2>Welcome to Linen</h2>
    <p>Linen is a personal AI assistant that actually respects your privacy. Unlike ChatGPT or other apps, everything you talk to Linen about stays on your deviceâ€”we don't sell your data or train on your conversations. It learns who you are over time, remembers what matters to you, and helps with reminders, planning, or just being there when you need support. Think of it as an AI that's actually on your side.</p>
    <h3>Key Differentiators:</h3>
    <ul>
        <li>ðŸ”’ Privacy First</li>
        <li>ðŸ§  Personalized</li>
        <li>ðŸ‘¤ You Own Your Data</li>
    </ul>
    <div class="pitch-buttons">
        <button id="try-free-btn" class="button-primary">Try Free (3 chats)</button>
        <button id="add-api-key-btn" class="button-secondary">Add My API Key</button>
    </div>
</div>

<div id="trial-limit-modal" class="modal">
    <h2>Free Preview Complete</h2>
    <p>You've used your 3 free chats. Get your own API key to continue chatting unlimitedly.</p>
    <a href="https://aistudio.google.com/app/apikey" target="_blank" class="button-primary">Get Free API Key</a>
    <button id="close-trial-modal" class="button-primary">Close</button>
</div>

<div id="re-enter-key-modal" class="modal">
    <h2>Invalid API Key</h2>
    <p>Your API key is no longer working. Please enter a new one to continue.</p>
    <input type="password" id="re-enter-api-key" placeholder="Paste your new API key here">
    <button id="save-re-enter-api-key">Save Key</button>
    <p class="error-message" id="re-enter-error"></p>
</div>

<div id="app-container">
    <header>
        <button id="settings-button">âš™</button>
        <img src="./logo.png" alt="Linen Logo" id="logo">
        <button id="memories-button">ðŸ“š</button>
    </header>

    <main class="main-content" id="chat-view">
        <div id="chat-messages"></div>
        <div id="chat-input-area">
            <textarea id="chat-input" placeholder="Ask me anything..."></textarea>
            <button id="chat-send">Send</button>
        </div>
    </main>

    <!-- Modals and Panels -->
    <div id="modal-backdrop"></div>

    <aside id="memories-panel">
        <button class="close-panel" id="close-memories">Ã—</button>
        <input id="memory-search" placeholder="Search memories...">
        <div id="memories-list">No memories yet.</div>
    </aside>

    <div class="modal" id="settings-modal">
        <button class="close-modal" id="close-settings-modal">Ã—</button>
        <input id="api-key-input" placeholder="Paste Gemini API key">
        <button id="save-api-key">Save API Key</button>
        <button id="clear-chat-history">Clear Chat History</button>
        <button id="export-data">Export Memories</button>
        <button id="clear-data">Clear All Data</button>
        <hr>
        <div id="contact-form">
            <h3>Contact Support</h3>
            <form action="https://formspree.io/f/xaqdnyzw" method="POST">
                <input type="text" name="name" placeholder="Your Name" required>
                <input type="email" name="email" placeholder="Your Email" required>
                <textarea name="message" placeholder="Your Message" required></textarea>
                <button type="submit">Send</button>
            </form>
        </div>
        <p id="version-info">v1.0.1 [beta]</p>
    </div>
</div>

<div id="toast"></div>

<script src="./app.js"></script>
</body>
</html>